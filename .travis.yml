language: go
os:
  - linux
  - osx

install:
    - go version && go env
    # run build and leave GOPATH in current environment
    - source ./build.sh
    # fetch test dependencies
    - go get -t -v ./...
    # - go get -u golang.org/x/lint/golint
    # - go get -u golang.org/x/tools/cmd/goimports
    # - go get gopkg.in/check.v1
    # - go get github.com/harmony-ek/gencodec
    # - go get github.com/golang/protobuf/protoc-gen-go
    # - ./scripts/install_protoc.sh -V 3.6.1
    # - ./scripts/travis_checker.sh
    # - go build -v ./...
script:
    - ./scripts/travis_checker.sh
# notify after failures separately for each os
after_failure:
      - wget https://raw.githubusercontent.com/DiscordHooks/travis-ci-discord-webhook/master/send.sh
      - chmod +x send.sh
      - ./send.sh failure $WEBHOOK_URL

jobs:
  include:
  - stage: Notify success
    # notify about success only once
    script:
      - wget https://raw.githubusercontent.com/DiscordHooks/travis-ci-discord-webhook/master/send.sh
      - chmod +x send.sh
      - ./send.sh success $WEBHOOK_URL

